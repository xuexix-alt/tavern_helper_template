{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_fcc8164c33ab268660e3819796c9f485/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/webpack/runtime/compat get default export","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","src://tavern_helper_template/external var \"Vue\"","webpack://tavern_helper_template/./src/店铺生成Demo/components/ErrorBoundary.vue?4eb0","webpack://tavern_helper_template/src/店铺生成Demo/components/ErrorBoundary.vue?38bf","src://tavern_helper_template/external var \"_\"","src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/美人团/schema.ts","src://tavern_helper_template/src/APP后台版/shared/shopStoreMvu.ts","src://tavern_helper_template/src/店铺生成Demo/utils/adapters/shop-generation.ts","src://tavern_helper_template/src/店铺生成Demo/utils/core.ts","webpack://tavern_helper_template/./src/店铺生成Demo/App.vue?fdfb","webpack://tavern_helper_template/src/店铺生成Demo/App.vue?ac3d","src://tavern_helper_template/src/店铺生成Demo/utils/schema.ts","src://tavern_helper_template/src/店铺生成Demo/index.ts"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, renderSlot as _renderSlot } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"error-boundary\"\n};\nconst _hoisted_2 = { class: \"error-content\" };\nimport { onErrorCaptured, ref } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ErrorBoundary',\n    setup(__props) {\n        const hasError = ref(false);\n        const errorMessage = ref('');\n        const error = ref(null);\n        // 捕获子组件错误\n        onErrorCaptured((err) => {\n            console.error('[错误边界] 捕获到组件错误:', err);\n            error.value = err;\n            hasError.value = true;\n            errorMessage.value = err.message || '发生了未知错误';\n            console.log('[系统提示] 页面出现错误，已自动恢复');\n            return false; // 阻止错误继续传播\n        });\n        // 重试函数\n        const retry = () => {\n            hasError.value = false;\n            error.value = null;\n            errorMessage.value = '';\n            // 强制重新渲染\n            window.location.reload();\n        };\n        return (_ctx, _cache) => {\n            return (hasError.value)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"i\", { class: \"fas fa-exclamation-triangle\" }, null, -1 /* CACHED */)),\n                        _cache[2] || (_cache[2] = _createElementVNode(\"h3\", null, \"页面出现错误\", -1 /* CACHED */)),\n                        _createElementVNode(\"p\", null, _toDisplayString(errorMessage.value), 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"retry-btn\",\n                            onClick: retry\n                        }, [...(_cache[0] || (_cache[0] = [\n                                _createElementVNode(\"i\", { class: \"fas fa-redo\" }, null, -1 /* CACHED */),\n                                _createTextVNode(\" 重新加载\", -1 /* CACHED */)\n                            ]))])\n                    ])\n                ]))\n                : _renderSlot(_ctx.$slots, \"default\", { key: 1 });\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ErrorBoundary.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ErrorBoundary.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ErrorBoundary.vue?vue&type=style&index=0&id=2afd6fa3&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_fcc8164c33ab268660e3819796c9f485/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2afd6fa3\"]])\n\nexport default __exports__","const __WEBPACK_NAMESPACE_OBJECT__ = _;","const __WEBPACK_NAMESPACE_OBJECT__ = z;","import _ from 'lodash';\nimport { z } from 'zod';\n\n// ---------------------\n// 1. 定义独立的部分 Schema\n// ---------------------\n\n// 初始店铺数据\nexport const INITIAL_SHOP_LIST = [\n  {\n    shopname: '【都市猎艳】擦肩而过的悸动',\n    shop_id: 20241222001,\n    shoptags: ['通勤日常', '制服诱惑', '公共场所'],\n    packages: [\n      {\n        name: '晚高峰的地铁OL·拥挤中的摩擦',\n        price: 588,\n        stars: 4.7,\n        icon: 'fas fa-subway',\n        tags: ['车厢痴汉', '职场正装', '强制接触'],\n        image1:\n          '###26岁、面容疲惫的中国职场女性，身着黑色修身西装套裙，站在拥挤的地铁车厢内，右手抓着高处扶手，腋下曲线展露。纪实摄影风格，Leica M10拍摄，35mm镜头。车厢内冷白顶光，面部明暗交界清晰，眼神放空。4K分辨率，皮肤毛孔可见，汗水微光。###',\n        image2:\n          '###女性腰部以下特写，黑色包臀裙被后方乘客挤压出明显的臀部轮廓，肉色丝袜包裹的大腿肌肉紧绷。微距摄影，浅景深。环境光昏暗，裙褶纹理清晰，丝袜光泽细腻。8K分辨率，材质质感真实。###',\n        image3:\n          '###俯视视角，女性白色衬衫领口第二颗纽扣崩开，露出黑色蕾丝内衣边缘及上胸部皮肤，汗珠沿锁骨滑落。特写镜头。局部高光照明，汗水反光强烈，皮肤白皙细腻。8K分辨率，无畸变，细节锐利。###',\n        description:\n          '那时候是周五的晚高峰，你在拥挤的地铁三号线上被挤得动弹不得。紧贴着你的是一位典型的都市OL，她身上的廉价香水味混合着忙碌一天的淡淡汗味钻进你的鼻孔。随着列车的晃动，她那穿包臀裙的丰满屁股一次次撞击你的胯下，你能感觉到她大腿肉在丝袜包裹下的温热和弹性。看着她为了保持平衡而高举手臂露出的衬衫崩开的缝隙，你那被生活压抑的欲望瞬间抬头。真想在这拥挤的人潮中，悄悄掀起她的裙子，在那无数人见证却无人察觉的角落，把肉棒狠狠顶进她湿热的小穴，让她只能咬着嘴唇不敢出声。',\n        content: ['在此刻拥挤的车厢内直接顶进去', '跟随她下车在站台卫生间快搞', '要把精液射在她的丝袜和高跟鞋上'],\n        reviews: [\n          '别...别在这里...会被发现的...求你...轻点...',\n          '来自路人视角：\"现在的年轻人真是大胆，地铁上都贴那么紧。\"',\n        ],\n      },\n      {\n        name: '写字楼的保洁阿姨·楼梯间的回响',\n        price: 388,\n        stars: 4.5,\n        icon: 'fas fa-broom',\n        tags: ['成熟韵味', '身份反差', '快速解决'],\n        image1:\n          '###42岁、身材丰腴的中国中年女性，身着灰色保洁制服，头发用发网盘起，正在擦拭楼梯扶手，面部表情专注。现实主义风格，Canon 5D Mark IV拍摄，50mm镜头。楼梯间感应灯光，侧光勾勒面部轮廓，氛围静谧。6K分辨率，面部细纹真实，妆容素淡。###',\n        image2:\n          '###女性弯腰擦拭地面的背影，宽松制服裤紧贴臀部，勒出宽大肥硕的臀型和内裤勒痕。中景镜头。顶部垂直光照，衣物褶皱阴影深重，体态敦实丰满。8K分辨率，布料质感粗糙，真实感强。###',\n        image3:\n          '###女性坐在楼梯台阶上休息，制服领口敞开，露出洗得发白的肉色大码文胸和深邃乳沟，胸部皮肤有汗渍。特写镜头。暗光环境，局部补光照亮胸部，皮肤松弛度符合年龄。8K分辨率，汗水细节清晰。###',\n        description:\n          '你在加班到深夜的写字楼里抽烟，透过防火门的玻璃，看到那个平时默默无闻的保洁阿姨正在拖地。她弯腰时，那肥硕的屁股把制服裤撑得满满当当，随着动作左右摇摆，透着一股成熟妇人特有的肉欲。她直起身擦汗，那并不精致但充满母性气息的脸庞让你想起了邻居家经常照顾你的阿姨。在这空无一人的深夜大楼里，这种原始的肉欲冲破了理智。你只想把她按在充满消毒水味道的楼梯间墙上，扒下那条廉价的裤子，在声控灯的忽明忽灭中，享用这具熟透了的、肥美多汁的身体。',\n        content: ['在楼梯间按着头后入', '让她趴在拖把池边服务', '射在她的保洁制服上'],\n        reviews: [\n          '小伙子...这不行...阿姨年纪都这么大了...脏...',\n          '来自保安：\"最近楼梯间怎么总有股怪味，得让保洁多拖几遍。\"',\n        ],\n      },\n      {\n        name: '星巴克的相亲女·被放鸽子的安慰',\n        price: 688,\n        stars: 4.8,\n        icon: 'fas fa-coffee',\n        tags: ['精心打扮', '情感趁虚', '高档场所'],\n        image1:\n          '###24岁、妆容精致的中国年轻女性，身着白色露肩连衣裙，独自坐在咖啡厅窗边，不停看手机，神情焦虑失落。都市人像摄影，Sony A7R IV拍摄，85mm f/1.4镜头。午后自然光透过落地窗，面部光影柔和，背景虚化唯美。8K分辨率，发丝光泽清晰，妆面无瑕。###',\n        image2:\n          '###女性双腿交叠坐在高脚椅上，连衣裙开叉处露出白皙大腿，脚上是一双精致的银色细高跟凉鞋，脚踝纤细。低角度拍摄。室内暖色氛围灯，腿部线条流畅，肤色均匀。8K分辨率，肌肉线条自然。###',\n        image3:\n          '###女性低头搅动咖啡，视角聚焦于连衣裙领口，深V设计展露饱满胸型，锁骨窝深陷，皮肤白嫩。特写镜头。柔和散射光，胸部阴影自然，项链反光清晰。8K分辨率，皮肤质感通透。###',\n        description:\n          '周六下午的星巴克，你注意到邻桌那个精心打扮的女孩已经等了一个小时。她穿着显身材的小礼服，化了全妆，显然是为了见重要的人，但电话那头传来的似乎是推脱之词。看着她从期待转为失落，眼眶微红地咬着吸管，那副楚楚可怜又带着点被羞辱后的愤懑模样，让你想起了那种扭曲的破坏欲。那些精心准备的妆容和衣着不该被浪费。你现在的冲动就是走过去，不用废话，直接在这个充满小资情调的咖啡馆厕所里，撕碎她的矜持，让她在你的胯下哭着发泄被抛弃的委屈。',\n        content: ['假装是相亲对象直接带走', '在咖啡馆残疾人卫生间速战', '让她含着满嘴精液补妆'],\n        reviews: [\n          '既然他不要我了...那你来爱我好不好...哪怕只是身体...',\n          '来自服务员：\"那桌客人好像哭了，要去送纸巾吗？\"',\n        ],\n      },\n    ],\n  },\n  {\n    shopname: '【市井芳香】生活转角的惊喜',\n    shop_id: 20241222002,\n    shoptags: ['邻家日常', '生活气息', '绝对隐私'],\n    packages: [\n      {\n        name: '深夜便利店的兼职学妹·收银台下的秘密',\n        price: 499,\n        stars: 4.8,\n        icon: 'fas fa-shopping-basket',\n        tags: ['青春活力', '制服短裙', '监控盲区'],\n        image1:\n          '###19岁、扎马尾辫的中国少女，身着红绿配色便利店制服，趴在收银台上打瞌睡，脸上充满胶原蛋白。日系生活摄影，Fujifilm X-T4拍摄，35mm镜头。店内高亮日光灯，面部光线平整，色彩鲜艳。4K分辨率，面部绒毛可见，神态自然。###',\n        image2:\n          '###少女站在货架前整理商品，短裙下露出一双穿着白色短袜的光洁小腿，膝盖粉嫩，大腿内侧线条紧致。全身镜头。冷白光源，腿部皮肤反光自然，无异常阴影。8K分辨率，腿部比例写实。###',\n        image3:\n          '###收银台内侧视角，少女坐在低矮板凳上玩手机，双腿大大张开，裙底白色棉质内裤和骆驼趾轮廓清晰可见。偷拍视角。光线昏暗，局部噪点真实，私密部位细节明确。8K分辨率，布料纹理清晰。###',\n        description:\n          '凌晨两点去楼下便利店买烟，店里只有那个兼职的大学生妹子。她正戴着耳机哼歌，完全没注意到你进门。制服裙短得离谱，当你假装挑关东煮时，看到她为了拿高处的纸巾踮起脚尖，裙摆上移露出了可爱的草莓胖次。这种毫无防备的青春肉体在深夜显得格外诱人。这会儿店里也没别人，监控死角你早就摸清了。你现在的脑子里只有一个念头：把\"暂停营业\"的牌子挂出去，把这个不知世间险恶的小学妹抱上收银台，就在那一堆口香糖和避孕孕套旁边，狠狠教她做大人的道理。',\n        content: ['在收银台把腿架在肩膀上干', '让她一边结账一边被手指玩弄', '射在热气腾腾的关东煮锅里'],\n        reviews: ['大叔...好痛...轻点...要是有人进来怎么办...', '来自店长：\"最近夜班盘点怎么总少东西？下次查查监控。\"'],\n      },\n      {\n        name: '取快递的邻家少妇·真空的睡衣',\n        price: 666,\n        stars: 4.6,\n        icon: 'fas fa-box-open',\n        tags: ['人妻背德', '居家私密', '真空上阵'],\n        image1:\n          '###28岁、素颜的中国少妇，身着淡粉色丝绸吊带睡裙，站在公寓楼道取件箱前，头发随意挽起。日常抓拍风格，iPhone 13 Pro拍摄。楼道声控暖光，面部光影立体，眼神慵懒。4K分辨率，皮肤质感真实，无美颜磨皮。###',\n        image2:\n          '###侧面视角，睡裙面料轻薄贴身，胸部两点突起明显，侧乳轮廓若隐若现，腰肢纤细。中景镜头。顶部光源，丝绸反光强烈，身体曲线毕露。8K分辨率，乳头凸起细节清晰。###',\n        image3:\n          '###少妇弯腰从低处柜门取快递，领口大开，那对硕大的乳房像水球一样垂下，深邃乳沟和乳晕边缘清晰可见。高机位俯拍。局部照明，胸部皮肤白皙，血管隐约可见。8K分辨率，重力下垂感真实。###',\n        description:\n          '你去小区丰巢柜取快递，正好碰见住你楼下的新婚少妇也在取件。她似乎觉得只是下楼一趟无所谓，只穿了一件薄得透光的真丝睡裙，里面明显是真空的。当她踮起脚够上层的柜门时，睡裙紧贴着身体，勾勒出那两粒硬挺的乳头和圆润的屁股蛋。那一瞬间，邻里之间的礼貌防线在你脑中崩塌。看着她毫无防备的背影，你想直接从后面捂住她的嘴，把她推进旁边的消防通道，撕开那层薄薄的阻碍，在这个随时可能有人经过的公用空间里，狠狠侵犯这个不守妇道的女人。',\n        content: ['在消防通道强行后入', '把她拖进自家玄关就开始做', '用快递盒垫着她的屁股干'],\n        reviews: ['别...那是邻居...会被听到的...啊...不行...', '来自你妈：\"楼下小媳妇挺热情的，下次见面打招呼。\"'],\n      },\n      {\n        name: '公园晨跑的瑜伽教练·汗湿的紧身裤',\n        price: 555,\n        stars: 4.9,\n        icon: 'fas fa-running',\n        tags: ['健康肉体', '紧身包裹', '野外露出'],\n        image1:\n          '###30岁、皮肤小麦色的中国运动女性，身着荧光色运动内衣和瑜伽裤，在公园长椅上压腿，汗水流淌。运动摄影风格，Nikon D850拍摄，70-200mm镜头。晨光逆光拍摄，发丝金黄，面部轮廓硬朗。8K分辨率，汗珠晶莹，肌肉线条清晰。###',\n        image2:\n          '###女性背部视角，紧身瑜伽裤将臀部包裹得浑圆挺翘，因为汗湿，布料嵌入臀缝，呈现清晰的\"W\"形。特写镜头。侧顺光，臀部立体感强，布料紧绷。8K分辨率，无异常拉伸，真实感极强。###',\n        image3:\n          '###女性做开合跳动作，胸部剧烈晃动，运动内衣勒出深陷的乳沟，腋下和胸口处有明显深色汗渍。抓拍镜头。高速快门凝固动作，光影对比强烈，荷尔蒙气息浓郁。8K分辨率，动态模糊极少，细节锐利。###',\n        description:\n          '你在公园晨跑时，总能遇到这个身材火辣的瑜伽教练。她穿着最紧身的运动装，做着各种高难度的拉伸动作，那被瑜伽裤勒出的骆驼趾和因为出汗而紧贴在身上的布料，简直就是行走的春药。今天她似乎跑累了，躲在小树林深处的长椅上休息，胸口剧烈起伏，大口喘着粗气。看着她那红扑扑的脸蛋和全是汗水的亮晶晶的大腿，你心里的野兽彻底觉醒。这里没人会来，你只想冲过去，利用她身体极佳的柔韧性，把她的双腿折叠到头上，在这充满草木清香的野外，品尝这具充满弹性和力量的肉体。',\n        content: ['在公园长椅上高难度体位', '按在树干上站立后入', '射在她满是汗水的马甲线上'],\n        reviews: [\n          '呼...呼...教练没教过这个动作...太深了...',\n          '来自公园大爷：\"现在的年轻人身体真好，大清早就练这么猛。\"',\n        ],\n      },\n    ],\n  },\n];\n\n// 店铺单项 Schema (从原 Schema 中提取，保留供内部使用)\nexport const ShopItemSchema = z\n  .object({\n    shopname: z.string(),\n    shop_id: z.coerce.number(),\n    shoptags: z.array(z.string()),\n    packages: z\n      .array(\n        z\n          .object({\n            name: z.string(),\n            price: z.coerce.number(),\n            stars: z.coerce.number(),\n            icon: z.string(),\n            tags: z.array(z.string()),\n            image1: z.string(),\n            image2: z.string(),\n            image3: z.string(),\n            description: z.string(),\n            content: z.array(z.string()),\n            reviews: z.array(z.string()),\n          })\n          .strict(),\n      )\n      .describe('套餐列表'),\n  })\n  .strict();\n\n// ---------------------\n// 2. 主 Schema (Message Scope / stat_data)\n// ---------------------\nexport const Schema = z.object({\n  经济: z\n    .object({\n      账户余额: z.coerce.number(),\n      订单消费: z.coerce.number(),\n    })\n    .strict(),\n  订单模板: z\n    .object({\n      新订单原型: z\n        .object({\n          id: z.string(),\n          订单状态: z.enum(['服务中', '服务结束']),\n          基础信息: z\n            .object({\n              姓名: z.string(),\n              年龄: z.coerce.number(),\n              身份: z.string(),\n              描述: z.string(),\n            })\n            .strict(),\n          服装: z.record(z.string(), z.string()),\n          套餐: z\n            .object({\n              套餐名称: z.string(),\n              套餐价格: z.coerce.number(),\n              折后价格: z.coerce.number(),\n              玩法特色: z.array(z.string()),\n              商品类型: z.string(),\n            })\n            .strict(),\n          心理状态: z\n            .object({\n              当前所想: z.string(),\n              好感度: z.coerce.number().transform(v => _.clamp(v, 0, 100)),\n              兴奋度: z.coerce.number().transform(v => _.clamp(v, 0, 100)),\n              性格类型: z.string(),\n            })\n            .strict(),\n          身体特征: z\n            .object({\n              三围: z.object({ 描述: z.string(), 罩杯: z.string() }).strict(),\n              乳房: z.object({ 形状: z.string() }).strict(),\n              姿势: z.string(),\n              胸部: z.string(),\n              私处: z.string(),\n            })\n            .strict(),\n          性经验: z\n            .object({\n              处女: z.enum(['是', '否']),\n              性伴侣数量: z.coerce.number(),\n              初次性行为对象: z.string(),\n              怀孕几率: z.coerce.number().transform(v => _.clamp(v, 0, 100)),\n              下单次数: z.coerce.number(),\n            })\n            .strict(),\n          服务统计: z\n            .object({\n              心跳: z.coerce.number().transform(v => _.clamp(v, 60, 200)),\n              本次服务性交次数: z.coerce.number(),\n              内射次数: z.coerce.number(),\n            })\n            .strict(),\n        })\n        .strict(),\n    })\n    .strict(),\n  系统状态: z\n    .object({\n      多人服务触发: z.boolean(),\n      复购记忆保留: z.boolean(),\n      当前场景: z.string(),\n      当前模式: z.string(),\n    })\n    .strict(),\n  推荐标签: z.array(z.string()).default(['zod店铺集成']),\n  服务中的订单: z\n    .record(\n      z.string().describe('订单ID'),\n      z\n        .object({\n          id: z.string(),\n          订单状态: z.enum(['服务中', '服务结束']),\n          基础信息: z\n            .object({\n              姓名: z.string(),\n              年龄: z.coerce.number(),\n              身份: z.string(),\n              描述: z.string(),\n            })\n            .strict(),\n          服装: z.record(z.string(), z.string()),\n          套餐: z\n            .object({\n              套餐名称: z.string(),\n              套餐价格: z.coerce.number(),\n              折后价格: z.coerce.number(),\n              玩法特色: z.array(z.string()),\n              商品类型: z.string(),\n            })\n            .strict(),\n          心理状态: z\n            .object({\n              当前所想: z.string(),\n              好感度: z.coerce.number().transform(v => _.clamp(v, 0, 100)),\n              兴奋度: z.coerce.number().transform(v => _.clamp(v, 0, 100)),\n              性格类型: z.string(),\n            })\n            .strict(),\n          身体特征: z\n            .object({\n              三围: z.object({ 描述: z.string(), 罩杯: z.string() }).strict(),\n              乳房: z.object({ 形状: z.string() }).strict(),\n              姿势: z.string(),\n              胸部: z.string(),\n              私处: z.string(),\n            })\n            .strict(),\n          性经验: z\n            .object({\n              处女: z.enum(['是', '否']),\n              性伴侣数量: z.coerce.number(),\n              初次性行为对象: z.string(),\n              怀孕几率: z.coerce.number().transform(v => _.clamp(v, 0, 100)),\n              下单次数: z.coerce.number(),\n            })\n            .strict(),\n          服务统计: z\n            .object({\n              心跳: z.coerce.number().transform(v => _.clamp(v, 60, 200)),\n              本次服务性交次数: z.coerce.number(),\n              内射次数: z.coerce.number(),\n            })\n            .strict(),\n        })\n        .strict(),\n    )\n    .prefault({}),\n  店铺列表: z.array(ShopItemSchema).default(INITIAL_SHOP_LIST),\n});\n\nexport type Schema = z.output<typeof Schema>;\n","// Tavern Helper globals\r\ndeclare function getVariables(scope: { type: string; script_id?: string; message_id?: number | string }): any;\r\ndeclare function replaceVariables(variables: any, scope: { type: string; script_id?: string; message_id?: number | string }): void;\r\ndeclare function getCurrentMessageId(): number;\r\ndeclare function waitGlobalInitialized(name: string): Promise<void> | void;\r\ndeclare const Mvu: any;\r\n\r\nimport { Schema, ShopItemSchema } from '../../美人团/schema';\n\n// 对齐美人团 Schema：店铺列表是数组（ShopItemSchema[]），作用域为当前楼层 stat_data\nexport type MvuShop = (typeof Schema)['_output']['店铺列表'][number];\n\nexport interface AppShop extends MvuShop {\n  id?: string; // 可选，若 json_patch 为 record 则来自 key\n}\n\nfunction normalizeToArray(value: any): MvuShop[] {\n  if (Array.isArray(value)) return value as MvuShop[];\n  if (value && typeof value === 'object') return Object.values(value);\n  return [];\n}\n\n// 为前端渲染补齐 ID（不写回 MVU，避免破坏 Schema）\nfunction addViewIds(shops: MvuShop[]): AppShop[] {\n  return (shops || []).map((shop, sIdx) => {\n    const rawShopId = (shop as any).shop_id ?? (shop as any).id ?? `shop_${sIdx}`;\n    const shopId = String(rawShopId);\n    const packages = Array.isArray((shop as any).packages)\n      ? (shop as any).packages.map((pkg: any, pIdx: number) => {\n          const pkgId = pkg?.id ?? `${shopId}_pkg_${pIdx}`;\n          return { ...pkg, id: String(pkgId), shop_id: shopId };\n        })\n      : [];\n    return {\n      ...(shop as any),\n      id: String((shop as any).id ?? shopId),\n      shop_id: (shop as any).shop_id,\n      packages,\n    };\n  });\n}\n\nexport const shopStoreMvu = {\n  getShops(): AppShop[] {\n    try {\n      const message_id = getCurrentMessageId?.() ?? 'latest';\n\r\n      try {\r\n        waitGlobalInitialized && waitGlobalInitialized('Mvu');\r\n      } catch (e) {\r\n        // ignore wait errors\r\n      }\r\n\r\n      const data = ((): any => {\r\n        if (typeof Mvu !== 'undefined' && Mvu?.getMvuData) {\r\n          return Mvu.getMvuData({ type: 'message', message_id });\r\n        }\r\n        return getVariables({ type: 'message', message_id });\r\n      })();\r\n\r\n      const statData = data?.stat_data || data || {};\r\n      const parsed = Schema.safeParse(statData);\r\n      const shopList = parsed.success ? parsed.data.店铺列表 : normalizeToArray(statData['店铺列表']);\n      return addViewIds(shopList);\n    } catch (e) {\n      console.error('[ShopStoreMVU] getShops failed', e);\n      return [];\n    }\n  },\n\r\n  saveShops(rawShops: any) {\r\n    try {\r\n      const message_id = getCurrentMessageId?.() ?? 'latest';\n      const shopsArray = normalizeToArray(rawShops);\n\n      // 校验/裁剪为 Schema 期望的结构\n      const safeShops = shopsArray\n        .map(shop => ShopItemSchema.safeParse(shop))\n        .filter(r => r.success)\n        .map(r => r.data);\n\n      if (safeShops.length === 0) {\n        console.warn('[ShopStoreMVU] saveShops skipped: no valid shops');\n        return;\n      }\n\n      const current = getVariables({ type: 'message', message_id }) || {};\n      const stat = current.stat_data || {};\n      const nextStat = { ...stat, 店铺列表: safeShops };\n\r\n      replaceVariables({ stat_data: nextStat }, { type: 'message', message_id });\r\n\r\n      window.dispatchEvent(new CustomEvent('shop:cache:updated'));\r\n    } catch (e) {\r\n      console.error('[ShopStoreMVU] saveShops failed', e);\r\n    }\r\n  },\r\n\r\n  deleteShop(id: string) {\r\n    try {\r\n      const newShops = this.getShops().filter((s: any) => String((s as any).id ?? '') !== String(id));\r\n      this.saveShops(newShops);\r\n    } catch (e) {\r\n      console.error('[ShopStoreMVU] deleteShop failed', e);\r\n    }\r\n  },\r\n};\r\n","import { shopStoreMvu } from '../../../APP后台版/shared/shopStoreMvu';\nimport { InteractionAdapter } from '../types';\n\n// 声明全局变量\ndeclare const Mvu: any;\ndeclare const waitGlobalInitialized: (name: string) => Promise<void>;\ndeclare const injectPrompts: any;\ndeclare const uninjectPrompts: any;\n\ninterface ShopGenerationInput {\n  keyword: string;\n}\n\ninterface ShopGenerationParsedData {\n  jsonPatch?: any[];\n  analysis?: string;\n}\n\nexport class ShopGenerationAdapter implements InteractionAdapter<ShopGenerationInput, ShopGenerationParsedData> {\n  async buildPrompt(input: ShopGenerationInput): Promise<string> {\n    // 注入提示词以激活世界书条目\n    // 这些提示词不会发送给AI，但会触发世界书的关键词扫描\n    const injectionId = `shop-generation-${Date.now()}`;\n\n    injectPrompts(\n      [\n        {\n          id: injectionId,\n          position: 'none', // 不发送给AI，仅用于激活世界书\n          depth: 0,\n          role: 'system',\n          content: '【后台系统触发指南】[mvu_update]变量列表 [mvu_update]变量更新格式',\n          should_scan: true, // 作为扫描文本激活世界书\n        },\n      ],\n      { once: true },\n    ); // 仅在下一次生成中有效\n\n    // 返回用户搜索指令\n    return `用户搜索：${input.keyword}\\n\\n请根据世界书规则生成店铺数据。`;\n  }\n\n  async parseResponse(rawText: string): Promise<ShopGenerationParsedData> {\n    console.log('[ShopGenerationAdapter] 开始解析响应，原始文本长度:', rawText.length);\n    console.log('[ShopGenerationAdapter] 原始文本前500字:', rawText.substring(0, 500));\n\n    const startTag = '[手机界面开始]';\n    const endTag = '[手机界面结束]';\n\n    const startIndex = rawText.indexOf(startTag);\n    const endIndex = rawText.indexOf(endTag);\n\n    console.log('[ShopGenerationAdapter] 标签位置 - 开始:', startIndex, '结束:', endIndex);\n\n    if (startIndex === -1 || endIndex === -1) {\n      console.warn('[ShopGenerationAdapter] 无法找到[手机界面开始]或[手机界面结束]标签');\n      console.warn('[ShopGenerationAdapter] 完整响应文本:', rawText);\n      return {};\n    }\n\n    const content = rawText.substring(startIndex + startTag.length, endIndex);\n    console.log('[ShopGenerationAdapter] 提取的内容长度:', content.length);\n    console.log('[ShopGenerationAdapter] 提取的内容:', content);\n\n    // 提取 json_patch\n    const jsonPatchMatch = content.match(/<json_patch>([\\s\\S]*?)<\\/json_patch>/);\n    console.log('[ShopGenerationAdapter] JSON Patch 匹配结果:', jsonPatchMatch ? '找到' : '未找到');\n\n    let jsonPatch = null;\n\n    if (jsonPatchMatch && jsonPatchMatch[1]) {\n      console.log('[ShopGenerationAdapter] JSON Patch 原始字符串:', jsonPatchMatch[1]);\n      try {\n        jsonPatch = JSON.parse(jsonPatchMatch[1].trim());\n        console.log('[ShopGenerationAdapter] JSON Patch 解析成功:', jsonPatch);\n      } catch (e) {\n        console.error('[ShopGenerationAdapter] JSON Patch 解析失败', e);\n        console.error('[ShopGenerationAdapter] 失败的 JSON 字符串:', jsonPatchMatch[1]);\n      }\n    }\n\n    // 提取分析内容\n    const analysisMatch = content.match(/<update_analysis>([\\s\\S]*?)<\\/update_analysis>/);\n    const analysis = analysisMatch ? analysisMatch[1].trim() : undefined;\n\n    return {\n      jsonPatch,\n      analysis,\n    };\n  }\n\n  async handleSideEffects(parsedData: ShopGenerationParsedData): Promise<void> {\n    // 由 MVU 引擎根据 <json_patch> 自动写入 stat_data；这里仅在写入后拉取最新店铺并通知前端\n    if (!parsedData.jsonPatch || !Array.isArray(parsedData.jsonPatch)) {\n      console.warn('[ShopGenerationAdapter] 未找到有效的 JSON Patch');\n      return;\n    }\n\n    // 等待 MVU 应用 patch（assistant 楼层使用 refresh:'affected' 会触发变量扫描）\n    await new Promise(resolve => setTimeout(resolve, 0));\n\n    try {\n      const shops = shopStoreMvu.getShops();\n      window.dispatchEvent(new CustomEvent('shop:cache:updated', { detail: { shops } }));\n      (window as any).__DEMO_SHOP_DATA__ = parsedData.jsonPatch;\n      console.log('[ShopGenerationAdapter] 已从 MVU 读取最新店铺并触发 UI 刷新');\n    } catch (e) {\n      console.error('[ShopGenerationAdapter] 读取 MVU 店铺失败', e);\n    }\n  }\n}\n","import { ExecutionOptions, InteractionAdapter, InteractionResult } from './types';\n\n// 声明全局变量，避免 TS 报错\ndeclare const eventOn: any;\ndeclare const iframe_events: any;\ndeclare const generate: any;\ndeclare const createChatMessages: any;\n\nexport class InlineInteractionService {\n  /**\n   * 执行同层交互流程\n   */\n  async execute<InputData, ParsedData>(\n    adapter: InteractionAdapter<InputData, ParsedData>,\n    input: InputData,\n    options: ExecutionOptions = { silentUser: true, silentAssistant: true, stream: true },\n  ): Promise<InteractionResult<ParsedData>> {\n    console.log('[InlineInteractionService] Start execution');\n\n    // 1. 构建 Prompt\n    const prompt = await adapter.buildPrompt(input);\n    console.log('[InlineInteractionService] Prompt built length:', prompt.length);\n\n    // 2. 写入用户历史 (Silent)\n    if (options.silentUser) {\n      const userContent = typeof input === 'string' ? input : '执行操作';\n      await this.addToHistory('user', userContent);\n    }\n\n    // 3. 准备流式监听\n    const onStream = (token: string) => {\n      if (options.stream && adapter.onStream) {\n        adapter.onStream(token);\n      }\n    };\n\n    if (options.stream && typeof eventOn === 'function' && typeof iframe_events !== 'undefined') {\n      try {\n        eventOn(iframe_events.STREAM_TOKEN_RECEIVED_INCREMENTALLY, onStream);\n      } catch (e) {\n        console.warn('Failed to register stream listener:', e);\n      }\n    }\n\n    // 4. 调用 LLM\n    console.log('[InlineInteractionService] Generating...');\n    // generate 返回最终的完整文本\n    const fullResponse = await generate({\n      user_input: prompt,\n      should_stream: options.stream,\n    });\n    console.log('[InlineInteractionService] Generation complete. Length:', fullResponse.length);\n\n    // 5. 解析响应\n    const parsedData = await adapter.parseResponse(fullResponse);\n    console.log('[InlineInteractionService] Response parsed');\n\n    // 6. 处理副作用 (MVU等)\n    await adapter.handleSideEffects(parsedData);\n    console.log('[InlineInteractionService] Side effects handled');\n\n    // 7. 写入 Assistant 历史\n    // 注意：必须使用 refresh: 'affected' 以触发MVU扫描和变量更新\n    if (options.silentAssistant) {\n      await this.addToHistory('assistant', fullResponse, true); // 第3个参数表示需要触发MVU\n    }\n\n    return {\n      rawResponse: fullResponse,\n      parsedData,\n    };\n  }\n\n  /**\n   * 添加消息到历史记录\n   * @param role 消息角色\n   * @param content 消息内容\n   * @param triggerMvu 是否触发MVU扫描（渲染消息）\n   */\n  private async addToHistory(role: 'user' | 'assistant', content: string, triggerMvu: boolean = false) {\n    try {\n      await createChatMessages([{ role, message: content }], {\n        // 如果需要触发MVU（assistant消息），使用 'affected' 触发渲染\n        // 否则使用 'none' 静默添加（user消息）\n        refresh: triggerMvu ? 'affected' : 'none',\n      });\n      console.log(`[InlineInteractionService] Added ${role} message (triggerMvu: ${triggerMvu})`);\n    } catch (e) {\n      console.warn('[InlineInteractionService] Failed to add history', e);\n    }\n  }\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, normalizeClass as _normalizeClass, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, withCtx as _withCtx, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = [\"data-theme\"];\nconst _hoisted_2 = { class: \"demo-container\" };\nconst _hoisted_3 = { class: \"header\" };\nconst _hoisted_4 = { class: \"input-section\" };\nconst _hoisted_5 = { class: \"search-bar\" };\nconst _hoisted_6 = [\"disabled\"];\nconst _hoisted_7 = { class: \"results-section\" };\nconst _hoisted_8 = { class: \"output-card raw-output\" };\nconst _hoisted_9 = { class: \"card-content\" };\nconst _hoisted_10 = { key: 0 };\nconst _hoisted_11 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_12 = { class: \"output-card parsed-output\" };\nconst _hoisted_13 = { class: \"card-content\" };\nconst _hoisted_14 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_15 = {\n    key: 1,\n    class: \"shop-list\"\n};\nconst _hoisted_16 = { class: \"shop-header\" };\nconst _hoisted_17 = { class: \"tags\" };\nconst _hoisted_18 = { class: \"packages\" };\nconst _hoisted_19 = { class: \"package-header\" };\nconst _hoisted_20 = { class: \"price\" };\nconst _hoisted_21 = { class: \"package-desc\" };\nimport { onMounted, onUnmounted, ref } from 'vue';\nimport ErrorBoundary from './components/ErrorBoundary.vue';\nimport { ShopGenerationAdapter } from './utils/adapters/shop-generation';\nimport { InlineInteractionService } from './utils/core';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'App',\n    setup(__props) {\n        const keyword = ref('');\n        const loading = ref(false);\n        const rawOutput = ref('');\n        const shopData = ref({});\n        const shopList = ref([]);\n        const currentTheme = ref('light');\n        const service = new InlineInteractionService();\n        const adapter = new ShopGenerationAdapter();\n        // 初始化主题\n        function initTheme() {\n            const savedTheme = localStorage.getItem('demo-theme') || 'light';\n            currentTheme.value = savedTheme;\n            document.documentElement.setAttribute('data-theme', savedTheme);\n            console.log(`[主题初始化] 已加载${savedTheme === 'dark' ? '深色' : '浅色'}模式`);\n        }\n        // 切换主题\n        function toggleTheme() {\n            const newTheme = currentTheme.value === 'light' ? 'dark' : 'light';\n            currentTheme.value = newTheme;\n            localStorage.setItem('demo-theme', newTheme);\n            document.documentElement.setAttribute('data-theme', newTheme);\n            console.log(`[主题切换] 已切换到${newTheme === 'dark' ? '深色' : '浅色'}模式`);\n        }\n        const handleShopUpdate = (event) => {\n            console.log('Received shop update:', event.detail);\n            const patch = event.detail;\n            if (Array.isArray(patch)) {\n                patch.forEach(p => {\n                    if (p.op === 'replace' && (p.path === '/店铺列表' || p.path === '店铺列表')) {\n                        shopData.value = p.value;\n                        shopList.value = Object.values(p.value);\n                    }\n                });\n            }\n        };\n        onMounted(() => {\n            initTheme();\n            window.addEventListener('shop-data-updated', handleShopUpdate);\n        });\n        onUnmounted(() => {\n            window.removeEventListener('shop-data-updated', handleShopUpdate);\n        });\n        async function handleSearch() {\n            if (!keyword.value)\n                return;\n            loading.value = true;\n            rawOutput.value = '';\n            const demoAdapter = Object.assign(Object.create(Object.getPrototypeOf(adapter)), adapter);\n            demoAdapter.onStream = (token) => {\n                rawOutput.value += token;\n            };\n            try {\n                await service.execute(demoAdapter, { keyword: keyword.value });\n            }\n            catch (e) {\n                console.error('Execution failed', e);\n                rawOutput.value += `\\nError: ${e}`;\n            }\n            finally {\n                loading.value = false;\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: \"phone-frame\",\n                \"data-theme\": currentTheme.value\n            }, [\n                _createCommentVNode(\" 错误边界组件 \"),\n                _createVNode(ErrorBoundary, null, {\n                    default: _withCtx(() => [\n                        _createElementVNode(\"div\", _hoisted_2, [\n                            _createCommentVNode(\" 头部 \"),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _cache[1] || (_cache[1] = _createElementVNode(\"h1\", null, [\n                                    _createElementVNode(\"i\", { class: \"fas fa-store\" }),\n                                    _createTextVNode(\" 店铺生成 Demo\")\n                                ], -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"theme-toggle\",\n                                    onClick: toggleTheme\n                                }, [\n                                    _createElementVNode(\"i\", {\n                                        class: _normalizeClass(currentTheme.value === 'dark' ? 'fas fa-sun' : 'fas fa-moon')\n                                    }, null, 2 /* CLASS */)\n                                ])\n                            ]),\n                            _createCommentVNode(\" 输入区域 \"),\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createElementVNode(\"div\", _hoisted_5, [\n                                    _cache[2] || (_cache[2] = _createElementVNode(\"i\", { class: \"fas fa-search\" }, null, -1 /* CACHED */)),\n                                    _withDirectives(_createElementVNode(\"input\", {\n                                        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((keyword).value = $event)),\n                                        placeholder: \"输入搜索关键词...\",\n                                        onKeyup: _withKeys(handleSearch, [\"enter\"])\n                                    }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                                        [_vModelText, keyword.value]\n                                    ])\n                                ]),\n                                _createElementVNode(\"button\", {\n                                    class: \"generate-btn\",\n                                    disabled: loading.value,\n                                    onClick: handleSearch\n                                }, [\n                                    _createElementVNode(\"i\", {\n                                        class: _normalizeClass(loading.value ? 'fas fa-spinner fa-spin' : 'fas fa-magic')\n                                    }, null, 2 /* CLASS */),\n                                    _createTextVNode(\" \" + _toDisplayString(loading.value ? '生成中...' : '生成店铺'), 1 /* TEXT */)\n                                ], 8 /* PROPS */, _hoisted_6)\n                            ]),\n                            _createCommentVNode(\" 结果区域 \"),\n                            _createElementVNode(\"div\", _hoisted_7, [\n                                _createCommentVNode(\" 流式输出 \"),\n                                _createElementVNode(\"div\", _hoisted_8, [\n                                    _cache[4] || (_cache[4] = _createElementVNode(\"div\", { class: \"card-header\" }, [\n                                        _createElementVNode(\"i\", { class: \"fas fa-stream\" }),\n                                        _createElementVNode(\"h3\", null, \"流式输出\")\n                                    ], -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_9, [\n                                        (rawOutput.value)\n                                            ? (_openBlock(), _createElementBlock(\"pre\", _hoisted_10, _toDisplayString(rawOutput.value), 1 /* TEXT */))\n                                            : (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [...(_cache[3] || (_cache[3] = [\n                                                    _createElementVNode(\"i\", { class: \"fas fa-inbox\" }, null, -1 /* CACHED */),\n                                                    _createElementVNode(\"p\", null, \"等待生成...\", -1 /* CACHED */)\n                                                ]))]))\n                                    ])\n                                ]),\n                                _createCommentVNode(\" 解析结果 \"),\n                                _createElementVNode(\"div\", _hoisted_12, [\n                                    _cache[8] || (_cache[8] = _createElementVNode(\"div\", { class: \"card-header\" }, [\n                                        _createElementVNode(\"i\", { class: \"fas fa-clipboard-list\" }),\n                                        _createElementVNode(\"h3\", null, \"解析结果 (MVU更新)\")\n                                    ], -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_13, [\n                                        (shopList.value.length === 0)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [...(_cache[5] || (_cache[5] = [\n                                                    _createElementVNode(\"i\", { class: \"fas fa-shopping-bag\" }, null, -1 /* CACHED */),\n                                                    _createElementVNode(\"p\", null, \"暂无店铺数据\", -1 /* CACHED */)\n                                                ]))]))\n                                            : (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(shopData.value, (shop, shopId) => {\n                                                    return (_openBlock(), _createElementBlock(\"div\", {\n                                                        key: shopId,\n                                                        class: \"shop-item\"\n                                                    }, [\n                                                        _createElementVNode(\"div\", _hoisted_16, [\n                                                            _createElementVNode(\"h4\", null, [\n                                                                _cache[6] || (_cache[6] = _createElementVNode(\"i\", { class: \"fas fa-store-alt\" }, null, -1 /* CACHED */)),\n                                                                _createTextVNode(\" \" + _toDisplayString(shop.shopname), 1 /* TEXT */)\n                                                            ]),\n                                                            _createElementVNode(\"div\", _hoisted_17, [\n                                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(shop.shoptags, (tag) => {\n                                                                    return (_openBlock(), _createElementBlock(\"span\", {\n                                                                        key: tag,\n                                                                        class: \"tag\"\n                                                                    }, [\n                                                                        _cache[7] || (_cache[7] = _createElementVNode(\"i\", { class: \"fas fa-tag\" }, null, -1 /* CACHED */)),\n                                                                        _createTextVNode(\" \" + _toDisplayString(tag), 1 /* TEXT */)\n                                                                    ]));\n                                                                }), 128 /* KEYED_FRAGMENT */))\n                                                            ])\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_18, [\n                                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(shop.packages, (pkg) => {\n                                                                return (_openBlock(), _createElementBlock(\"div\", {\n                                                                    key: pkg.name,\n                                                                    class: \"package-item\"\n                                                                }, [\n                                                                    _createElementVNode(\"div\", _hoisted_19, [\n                                                                        _createElementVNode(\"h5\", null, _toDisplayString(pkg.name), 1 /* TEXT */),\n                                                                        _createElementVNode(\"span\", _hoisted_20, \"¥\" + _toDisplayString(pkg.price), 1 /* TEXT */)\n                                                                    ]),\n                                                                    _createElementVNode(\"p\", _hoisted_21, _toDisplayString(pkg.description), 1 /* TEXT */)\n                                                                ]));\n                                                            }), 128 /* KEYED_FRAGMENT */))\n                                                        ])\n                                                    ]));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ]))\n                                    ])\n                                ])\n                            ])\n                        ])\n                    ]),\n                    _: 1 /* STABLE */\n                })\n            ], 8 /* PROPS */, _hoisted_1));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./App.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./App.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&id=c8801eb2&lang=scss\"\nimport \"./App.vue?vue&type=style&index=1&id=c8801eb2&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.2_fcc8164c33ab268660e3819796c9f485/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-c8801eb2\"]])\n\nexport default __exports__","import { z } from 'zod';\n\ndeclare const registerMvuSchema: (schema: any) => void;\ndeclare const $: any;\n\n/**\n * MVU Zod Schema 定义\n * 用于店铺生成Demo的变量结构验证\n */\nexport const ShopSchema = z.object({\n  经济: z\n    .object({\n      账户余额: z.coerce.number(),\n      订单消费: z.coerce.number(),\n    })\n    .strict(),\n  店铺列表: z\n    .record(\n      z.string().describe('店铺ID'),\n      z\n        .object({\n          shopname: z.string(),\n          shop_id: z.coerce.number(),\n          shoptags: z.array(z.string()),\n          packages: z.array(\n            z\n              .object({\n                name: z.string(),\n                price: z.coerce.number(),\n                stars: z.coerce.number().transform(v => _.clamp(v, 1, 5)),\n                icon: z.string(),\n                tags: z.array(z.string()),\n                image1: z.string(),\n                image2: z.string(),\n                image3: z.string(),\n                description: z.string(),\n                content: z.array(z.string()),\n                reviews: z.array(z.string()),\n              })\n              .strict(),\n          ),\n        })\n        .strict(),\n    )\n    .default({}),\n});\n\n/**\n * 注册MVU Schema\n * 必须在jQuery ready后调用\n */\nexport function registerShopSchema() {\n  if (typeof $ !== 'undefined') {\n    $(() => {\n      if (typeof registerMvuSchema === 'function') {\n        console.log('[ShopSchema] 正在注册MVU Schema...');\n        registerMvuSchema(ShopSchema);\n        console.log('[ShopSchema] MVU Schema注册成功');\n      } else {\n        console.warn('[ShopSchema] registerMvuSchema函数未找到，请确保MVU Zod框架已加载');\n      }\n    });\n  }\n}\n","import { createApp } from 'vue';\nimport App from './App.vue';\nimport { registerShopSchema } from './utils/schema';\n\n// jQuery-like ready function\nfunction ready(fn: () => void) {\n  if (document.readyState !== 'loading') {\n    fn();\n  } else {\n    document.addEventListener('DOMContentLoaded', fn);\n  }\n}\n\nready(() => {\n  // 1. 注册MVU Schema（必须在Vue之前）\n  registerShopSchema();\n\n  // 2. 挂载Vue应用\n  createApp(App).mount('#app');\n\n  // 3. 显示加载成功提示\n  if (typeof toastr !== 'undefined') {\n    toastr.success('店铺生成 Demo 加载成功!');\n  } else {\n    console.log('店铺生成 Demo 加载成功!');\n  }\n});\n\n// For Tavern Helper hot-reloading (if enabled)\n// @ts-expect-error - webpack-hot-middleware types not included in default TS environment\nif (import.meta.hot) {\n  // @ts-expect-error - import.meta.hot.accept is a webpack HMR API\n  import.meta.hot.accept();\n}\n"],"names":["exports","sfc","props","target","__vccOpts","key","val","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","module","__webpack_modules__","n","getter","__esModule","d","a","definition","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Vue","_hoisted_1","class","_hoisted_2","__name","setup","__props","hasError","ref","errorMessage","error","onErrorCaptured","err","console","value","message","log","retry","window","location","reload","_ctx","_cache","onClick","$slots","_","z","ShopItemSchema","object","shopname","string","shop_id","coerce","number","shoptags","array","packages","name","price","stars","icon","tags","image1","image2","image3","description","content","reviews","strict","describe","Schema","id","enum","record","transform","v","boolean","default","prefault","normalizeToArray","Array","isArray","values","shopStoreMvu","getShops","message_id","getCurrentMessageId","waitGlobalInitialized","e","data","Mvu","getMvuData","type","getVariables","statData","stat_data","parsed","safeParse","shopList","success","map","shop","sIdx","rawShopId","shopId","String","pkg","pIdx","pkgId","saveShops","rawShops","safeShops","filter","r","length","warn","current","nextStat","replaceVariables","dispatchEvent","CustomEvent","deleteShop","newShops","this","s","ShopGenerationAdapter","buildPrompt","input","injectionId","Date","now","injectPrompts","position","depth","role","should_scan","once","keyword","parseResponse","rawText","substring","startTag","startIndex","indexOf","endIndex","jsonPatchMatch","match","jsonPatch","JSON","parse","trim","analysisMatch","analysis","handleSideEffects","parsedData","Promise","resolve","setTimeout","shops","detail","__DEMO_SHOP_DATA__","InlineInteractionService","execute","adapter","options","silentUser","silentAssistant","stream","prompt","userContent","addToHistory","onStream","token","eventOn","iframe_events","STREAM_TOKEN_RECEIVED_INCREMENTALLY","fullResponse","generate","user_input","should_stream","rawResponse","triggerMvu","createChatMessages","refresh","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","loading","rawOutput","shopData","currentTheme","service","toggleTheme","newTheme","localStorage","setItem","document","documentElement","setAttribute","handleShopUpdate","event","patch","forEach","p","op","path","async","handleSearch","demoAdapter","assign","create","getPrototypeOf","onMounted","savedTheme","getItem","initTheme","addEventListener","onUnmounted","removeEventListener","ErrorBoundary","$event","placeholder","onKeyup","disabled","tag","ShopSchema","clamp","fn","$","registerMvuSchema","createApp","App","mount","toastr","readyState"],"ignoreList":[],"sourceRoot":""}
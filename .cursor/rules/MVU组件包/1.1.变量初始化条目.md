# 模块1.1：变量初始化条目生成指令

## 模块定义

本模块负责为已定义的 Zod Schema 生成符合类型约束的初始值。

**重要说明**：
- **前置依赖**：必须先完成模块1.0（变量结构设计脚本），本模块基于该 Schema 生成初始值
- 此模块专门负责变量的初始化，只包含初始值
- 更新规则在模块2中单独定义
- 通过 Zod Schema 提供类型安全和结构约束

---

## 生成任务

读取模块1.0生成的 `变量结构.js` 文件，基于其中的 Zod Schema 定义，生成一个满足该 Schema 的初始值 YAML 数据块。

**前置步骤**：
1. 使用 Read 工具读取 `变量结构.js` 文件
2. 分析文件中的 Schema 定义
3. 如果文件不存在，提示用户先完成模块1.0

---

## YAML 格式规范

### 基本规则

1. **纯净数据**：数据块内禁止使用任何形式的注释（`#` 或其他）
2. **格式**：使用 YAML 格式，简洁清晰
3. **类型匹配**：所有值必须符合 Schema 中定义的类型要求
4. **结构对齐**：变量结构必须与 Schema 定义一致

### 变量初始化原则

- **严格遵循 Schema**：所有字段必须符合 Zod Schema 的定义
- **合理的初始值**：根据项目背景设置有意义的初始状态
- **类型正确性**：
  - 数字类型使用数字字面量（如 `0`、`0.5`）
  - 字符串使用引号或直接书写
  - 布尔值使用 `true`/`false`
  - 对象使用嵌套结构
  - 空对象使用 `{}`
- **不添加 Schema 外字段**：仅初始化 Schema 中定义的字段

---

## 示例模板

### 输入示例（读取的 `变量结构.js` 文件）

```js
import { registerMvuSchema } from 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/util/mvu_zod.js';

export const Schema = z.object({
  络络: z.object({
    亲密度: z.coerce.number(),
    阅读日记数量: z.coerce.number(),
    拥有联系方式: z.boolean(),
    物品栏: z.record(z.string(), z.any()).prefault({})
  }),
  世界: z.object({
    当前日期: z.string(),
    当前星期: z.string(),
    当前时间: z.string()
  })
});

$(() => {
  registerMvuSchema(Schema);
})
```

### 输出示例（生成的初始值）

```yaml
络络:
  亲密度: 0
  阅读日记数量: 0
  拥有联系方式: false
  物品栏: {}
世界:
  当前日期: 2025-07-26
  当前星期: 星期五
  当前时间: 17:36
```

**注意**：
- YAML 格式比 JSON5 更简洁，适合人工阅读和编辑
- 数字、布尔值直接书写，字符串可加引号也可不加
- 空对象使用 `{}`
- 根据 Schema 中的类型定义设置合适的初始值

---

## 输出要求

### 1. 读取并检查文件

**操作步骤**：
1. 使用 Read 工具读取 `变量结构.js` 文件
2. 如果文件不存在，输出以下提示：

```
找不到 `变量结构.js` 文件，请先使用模块1.0（变量结构设计脚本）生成 Zod Schema。
```

### 2. 主体内容

**如果成功读取到** `变量结构.js` **文件**：

分析其中的 Schema 定义，生成一个 YAML 格式的初始值数据块：

```yaml
络络:
  亲密度: 0
  阅读日记数量: 0
  拥有联系方式: false
  物品栏: {}
世界:
  当前日期: 2025-07-26
  当前星期: 星期五
  当前时间: 17:36
```

**格式要求**：
- 使用 YAML 格式（不是 JSON5）
- 不包含任何注释
- 仅包含变量名和初始值
- 直接输出 YAML 内容，作为响应的主体部分

---

## 生成指令

生成内容后，使用 Write 工具将 YAML 数据块保存到 `[initvar]变量初始化.yaml` 文件中。

---

## 重要提醒

- **读取文件**：必须先使用 Read 工具读取 `变量结构.js` 文件
- **类型安全**：所有初始值必须与 Schema 定义的类型匹配
- **必需字段**：Schema 中未标记为 `.optional()` 或 `.prefault()` 的字段必须提供初始值
- **空值处理**：使用 `.prefault({})` 的字段可以初始化为空对象 `{}`
- **数字字面量**：虽然 Schema 使用了 `z.coerce.number()`，但初始值应直接使用数字字面量，不要使用字符串
